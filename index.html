<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•™è‚²ç¾å ´ã®ãŸã‚ã®è‘—ä½œæ¨©ã‚»ãƒ«ãƒ•ãƒã‚§ãƒƒã‚«ãƒ¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap');
        
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #f0f7ff;
            color: #334155;
        }

        .card-container {
            background-color: #ffffff;
            border-radius: 24px;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05);
        }

        .step-card {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }

        .step-card.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .btn-choice {
            transition: all 0.2s ease;
            border: 2px solid #e2e8f0;
            background: #ffffff;
        }

        .btn-choice:hover {
            border-color: #60a5fa;
            background-color: #f8fbff;
        }

        .progress-bar {
            height: 8px;
            background-color: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #60a5fa, #3b82f6);
            transition: width 0.4s ease;
        }
    </style>
</head>
<body class="p-4 md:p-8 flex items-center justify-center min-h-screen">

    <div class="max-w-2xl w-full">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-2xl md:text-3xl font-bold text-slate-800 mb-2">è‘—ä½œæ¨©ã‚»ãƒ«ãƒ•ãƒã‚§ãƒƒã‚«ãƒ¼</h1>
            <p class="text-slate-500 text-sm">ãã®æ•™æã€æˆæ¥­ã§ä½¿ã£ã¦ã‚‚å¤§ä¸ˆå¤«ï¼Ÿ</p>
        </header>

        <!-- Main Card -->
        <main class="card-container overflow-hidden">
            
            <!-- Tabs -->
            <div class="flex bg-slate-50 border-b border-slate-100 p-1">
                <button onclick="switchTab('checker')" id="tab-checker" class="flex-1 py-3 text-sm font-bold rounded-xl transition bg-white text-blue-600 shadow-sm">
                    ä½¿ã„é“ãƒã‚§ãƒƒã‚¯
                </button>
                <button onclick="switchTab('generator')" id="tab-generator" class="flex-1 py-3 text-sm font-bold rounded-xl transition text-slate-500 hover:bg-white/50">
                    å‡ºå…¸ï¼ˆåå‰ï¼‰ã‚’æ›¸ã
                </button>
            </div>

            <!-- TAB 1: Diagnostic -->
            <div id="content-checker" class="p-6 md:p-10">
                
                <div id="progress-area" class="mb-8 hidden">
                    <div class="flex justify-between text-[10px] font-bold text-slate-400 mb-1 uppercase tracking-widest">
                        <span>é€²ã¿ãã‚ã„</span>
                        <span id="progress-text">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
                    </div>
                </div>

                <div id="quiz-container">
                    <!-- Step 0: Disclaimer -->
                    <div id="step0" class="step-card active">
                        <div class="mb-8">
                            <h2 class="text-lg font-bold mb-4 text-slate-800">ä½¿ã†å‰ã«ç¢ºèªã—ã¦ãã ã•ã„</h2>
                            <div class="bg-blue-50 border border-blue-100 p-5 rounded-2xl text-sm text-blue-900 leading-relaxed space-y-4">
                                <div class="bg-white/60 p-4 rounded-xl">
                                    <p class="font-bold mb-2">ã€å‚è€ƒã«ã—ãŸã‚‚ã®ã€‘</p>
                                    <ul class="list-disc ml-5 text-xs space-y-1">
                                        <li>è‘—ä½œæ¨©æ³• ç¬¬35æ¡ï¼ˆæ•™è‚²ã§ã®åˆ©ç”¨ãƒ«ãƒ¼ãƒ«ï¼‰</li>
                                        <li>æ”¹æ­£è‘—ä½œæ¨©æ³•ç¬¬35æ¡é‹ç”¨æŒ‡é‡ï¼ˆSARTRASï¼‰</li>
                                        <li>æ–‡éƒ¨ç§‘å­¦çœã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³</li>
                                    </ul>
                                </div>
                                <p class="text-xs text-slate-500">â€»ã“ã®ã‚¢ãƒ—ãƒªã¯ã€Œå­¦æ ¡ã®æˆæ¥­ã€ã§ä½¿ã†ã¨ãã®ãŸã‚ã®ç›®å®‰ã§ã™ã€‚æœ€çµ‚çš„ãªåˆ¤æ–­ã¯ã€å­¦æ ¡ã®æ³•å‹™æ‹…å½“ã‚„å°‚é–€å®¶ã«ã”ç›¸è«‡ãã ã•ã„ã€‚</p>
                            </div>
                        </div>
                        <button onclick="startDiagnostic()" class="w-full py-4 bg-blue-600 text-white font-bold rounded-2xl hover:bg-blue-700 transition shadow-lg shadow-blue-200">
                            åŒæ„ã—ã¦ã¯ã˜ã‚ã‚‹
                        </button>
                    </div>

                    <!-- Step 1: Who -->
                    <div id="step1" class="step-card">
                        <h2 class="text-xl font-bold mb-6 text-slate-800">Q1. ã‚ãªãŸã¯ã€å­¦æ ¡ã®å…ˆç”Ÿã‚„ç”Ÿå¾’ã§ã™ã‹ï¼Ÿ</h2>
                        <div class="space-y-3">
                            <button onclick="nextStep(1, 'yes')" class="btn-choice w-full p-5 rounded-2xl text-left">
                                <span class="font-bold text-lg block">ã¯ã„</span>
                                <span class="text-sm text-slate-400">å­¦æ ¡ã®æ•™è·å“¡ã‚„ã€æˆæ¥­ã‚’å—ã‘ã‚‹äºº</span>
                            </button>
                            <button onclick="showResult('warning', 'ç‰¹åˆ¥ãªãƒ«ãƒ¼ãƒ«ï¼ˆ35æ¡ï¼‰ã¯ä½¿ãˆã¾ã›ã‚“', 'å¡¾ã€ç¿’ã„äº‹ã€å€‹äººã®å‹•ç”»ä½œã‚Šãªã©ã¯å­¦æ ¡æ•™è‚²ã«å«ã¾ã‚Œã¾ã›ã‚“ã€‚ä½œè€…ã«è¨±å¯ã‚’ã¨ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚')" class="btn-choice w-full p-5 rounded-2xl text-left">
                                <span class="font-bold text-lg block">ã„ã„ãˆ</span>
                                <span class="text-sm text-slate-400">å¡¾ã€ä¼šç¤¾ã€å€‹äººã®æ´»å‹•ãªã©</span>
                            </button>
                        </div>
                    </div>

                    <!-- Step 2: Purpose -->
                    <div id="step2" class="step-card">
                        <h2 class="text-xl font-bold mb-6 text-slate-800">Q2. ãã‚Œã¯ã€Œæˆæ¥­ã€ã§ä½¿ã†ã‚‚ã®ã§ã™ã‹ï¼Ÿ</h2>
                        <p class="text-xs text-slate-400 mb-4">â€»éƒ¨æ´»å‹•ã‚„æ•™è·å“¡ä¼šè­°ã€å­¦æ ¡è¡Œäº‹ã‚‚å«ã¿ã¾ã™ã€‚</p>
                        <div class="space-y-3">
                            <button onclick="nextStep(2, 'yes')" class="btn-choice w-full p-5 rounded-2xl text-left">
                                <span class="font-bold text-lg block">ã¯ã„</span>
                                <span class="text-sm text-slate-400">æˆæ¥­ã®é…å¸ƒã€ã‚¹ãƒ©ã‚¤ãƒ‰è¡¨ç¤ºã€ãƒãƒƒãƒˆæå‡ºãªã©</span>
                            </button>
                            <button onclick="showResult('warning', 'ç‰¹åˆ¥ãªãƒ«ãƒ¼ãƒ«ã¯ä½¿ãˆã¾ã›ã‚“', 'å­¦æ ¡ã®ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã«è¼‰ã›ã‚‹ã€åºƒå ±èªŒã«è¼‰ã›ã‚‹ã€ä¸€èˆ¬å…¬é–‹ã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆãªã©ã¯ã€Œæˆæ¥­ã€ã§ã¯ãªã„ãŸã‚ã€åˆ¥é€”è¨±å¯ãŒå¿…è¦ã§ã™ã€‚')" class="btn-choice w-full p-5 rounded-2xl text-left">
                                <span class="font-bold text-lg block">ã„ã„ãˆ</span>
                                <span class="text-sm text-slate-400">å­¦æ ¡ã®å®£ä¼ã€ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã§ã®ä¸€èˆ¬å…¬é–‹ãªã©</span>
                            </button>
                        </div>
                    </div>

                    <!-- Step 3: Material -->
                    <div id="step3" class="step-card">
                        <h2 class="text-xl font-bold mb-6 text-slate-800">Q3. ä½¿ã†è³‡æ–™ã¯ã€Œãƒ‰ãƒªãƒ«ã€ã‚„ã€Œå•é¡Œé›†ã€ã§ã™ã‹ï¼Ÿ</h2>
                        <div class="space-y-3">
                            <button onclick="showResult('critical', 'ä½¿ã‚ãªã„ã»ã†ãŒã‚ˆã„ã§ã™', 'ãƒ‰ãƒªãƒ«ãªã©ã®ã€Œè²·ã£ã¦ã‚‚ã‚‰ã†ã“ã¨ã€ã‚’å‰æã¨ã—ãŸæ•™æã¯ã€ã‚³ãƒ”ãƒ¼ã—ã¦é…ã‚‹ã¨ä½œè€…ã‚„å‡ºç‰ˆç¤¾ãŒå›°ã£ã¦ã—ã¾ã„ã¾ã™ã€‚åŸå‰‡ã¨ã—ã¦ã€å…¨å“¡åˆ†ã‚’è³¼å…¥ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚')" class="btn-choice w-full p-5 rounded-2xl text-left">
                                <span class="font-bold text-lg block">ã¯ã„</span>
                                <span class="text-sm text-slate-400">å¸‚è²©ã®ãƒ‰ãƒªãƒ«ã€ãƒ¯ãƒ¼ã‚¯ãƒ–ãƒƒã‚¯ã€ãƒ†ã‚¹ãƒˆé›†ãªã©</span>
                            </button>
                            <button onclick="nextStep(3, 'yes')" class="btn-choice w-full p-5 rounded-2xl text-left">
                                <span class="font-bold text-lg block">ã„ã„ãˆ</span>
                                <span class="text-sm text-slate-400">æ™®é€šã®æ›¸ç±ã€æ–°èã€ãƒãƒƒãƒˆã®è¨˜äº‹ã€å†™çœŸãªã©</span>
                            </button>
                        </div>
                    </div>

                    <!-- Step 4: Method -->
                    <div id="step4" class="step-card">
                        <h2 class="text-xl font-bold mb-6 text-slate-800">Q4. ãƒãƒƒãƒˆï¼ˆLMSã‚„ãƒ¡ãƒ¼ãƒ«ï¼‰ã§é€ã‚Šã¾ã™ã‹ï¼Ÿ</h2>
                        <div class="space-y-3">
                            <button onclick="nextStep(4, 'yes')" class="btn-choice w-full p-5 rounded-2xl text-left">
                                <span class="font-bold text-lg block">ã¯ã„</span>
                                <span class="text-sm text-slate-400">Classroomã‚„Teamsã€ãƒ¡ãƒ¼ãƒ«ã§é€ã‚‹</span>
                            </button>
                            <button onclick="nextStep(4, 'offline')" class="btn-choice w-full p-5 rounded-2xl text-left">
                                <span class="font-bold text-lg block">ã„ã„ãˆï¼ˆç´™ã§é…ã‚‹ãƒ»æŠ•å½±ã®ã¿ï¼‰</span>
                                <span class="text-sm text-slate-400">æ•™å®¤ã§ãƒ—ãƒªãƒ³ãƒˆã‚’é…ã‚‹ã€ç”»é¢ã«è¦‹ã›ã‚‹ã ã‘</span>
                            </button>
                        </div>
                    </div>

                    <!-- Step 5: Amount -->
                    <div id="step5" class="step-card">
                        <h2 class="text-xl font-bold mb-6 text-slate-800">Q5. ä½¿ã†ã®ã¯ã€Œã”ãä¸€éƒ¨ã€ã ã‘ã§ã™ã‹ï¼Ÿ</h2>
                        <div class="space-y-3">
                            <button onclick="nextStep(5, 'yes')" class="btn-choice w-full p-5 rounded-2xl text-left">
                                <span class="font-bold text-lg block">ã¯ã„ï¼ˆä¸€éƒ¨åˆ†ã ã‘ï¼‰</span>
                                <span class="text-sm text-slate-400">æœ¬ã®æ•°ãƒšãƒ¼ã‚¸ã€è¨˜äº‹ã®1ã¤ã€å†™çœŸã®1æšãªã©</span>
                            </button>
                            <button onclick="showResult('warning', 'ã€Œå…¨éƒ¨ã€ã®ã‚³ãƒ”ãƒ¼ã¯åŸå‰‡ãƒ€ãƒ¡ã§ã™', '1å†Šä¸¸ã”ã¨ã‚³ãƒ”ãƒ¼ã—ãŸã‚Šã€é›‘èªŒã‚’ã™ã¹ã¦ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸã‚Šã™ã‚‹ã®ã¯NGã§ã™ã€‚ä¿³å¥ã‚„å†™çœŸãªã©ã€çŸ­ã™ãã¦åˆ†ã‘ã‚‰ã‚Œãªã„ã‚‚ã®ä»¥å¤–ã¯ã€ä¸€éƒ¨ã ã‘ä½¿ã†ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚')" class="btn-choice w-full p-5 rounded-2xl text-left">
                                <span class="font-bold text-lg block">ã„ã„ãˆï¼ˆå…¨éƒ¨ã¾ãŸã¯å¤§éƒ¨åˆ†ï¼‰</span>
                                <span class="text-sm text-slate-400">æœ¬ã‚’ä¸€å†Šä¸¸ã”ã¨ã€é›‘èªŒã‚’ä¸€å†Šã¾ã‚‹ã”ã¨ãªã©</span>
                            </button>
                        </div>
                    </div>

                    <!-- Step 6: Change -->
                    <div id="step6" class="step-card">
                        <h2 class="text-xl font-bold mb-6 text-slate-800">Q6. å†…å®¹ã‚’æ›¸ãæ›ãˆã¦ä½¿ã„ã¾ã™ã‹ï¼Ÿ</h2>
                        <p class="text-xs text-slate-400 mb-4">â€»ç¿»è¨³ã‚„è¦ç´„ã€å›³ã®æãç›´ã—ãªã©ã€‚</p>
                        <div class="space-y-3">
                            <button onclick="nextStep(6, 'yes')" class="btn-choice w-full p-5 rounded-2xl text-left">
                                <span class="font-bold text-lg block">ã¯ã„</span>
                                <span class="text-sm text-slate-400">ç¿»è¨³ã™ã‚‹ã€è¦ç´„ã™ã‚‹ã€å›³ã‚’ã‚¢ãƒ¬ãƒ³ã‚¸ã™ã‚‹ãªã©</span>
                            </button>
                            <button onclick="nextStep(6, 'no')" class="btn-choice w-full p-5 rounded-2xl text-left">
                                <span class="font-bold text-lg block">ã„ã„ãˆ</span>
                                <span class="text-sm text-slate-400">å…ƒã®ã¾ã¾ä½¿ã†</span>
                            </button>
                        </div>
                    </div>

                    <!-- Step 7: System -->
                    <div id="step7" class="step-card">
                        <h2 class="text-xl font-bold mb-6 text-slate-800">Q7. å­¦æ ¡ã¯è£œå„Ÿé‡‘ã®åˆ¶åº¦ã«å…¥ã£ã¦ã„ã¾ã™ã‹ï¼Ÿ</h2>
                        <div class="space-y-3">
                            <button onclick="showResult('success', 'æˆæ¥­ã§ä½¿ã£ã¦å¤§ä¸ˆå¤«ã§ã™', 'ç„¡è¨±å¯ã§åˆ©ç”¨ã§ãã¾ã™ãŒã€å¿…ãšã€Œã©ã“ã‹ã‚‰å–ã£ãŸã‹ï¼ˆå‡ºå…¸ï¼‰ã€ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚ãƒãƒƒãƒˆé…ä¿¡ã‚‚OKã§ã™ã€‚')" class="btn-choice w-full p-5 rounded-2xl text-left">
                                <span class="font-bold text-lg block">ã¯ã„ / ãŠãã‚‰ãå…¥ã£ã¦ã„ã‚‹</span>
                                <span class="text-sm text-slate-400">å›½å†…ã®ã»ã¨ã‚“ã©ã®å­¦æ ¡ã¯åŠ å…¥æ¸ˆã¿ã§ã™</span>
                            </button>
                            <button onclick="showResult('warning', 'ãƒãƒƒãƒˆé…ä¿¡ã¯æ§ãˆã¦ãã ã•ã„', 'ç´™ã§é…ã‚‹ã ã‘ãªã‚‰OKã§ã™ãŒã€ãƒãƒƒãƒˆã§é€ã‚‹ã«ã¯ç‰¹åˆ¥ãªæ‰‹ç¶šããŒå¿…è¦ã§ã™ã€‚äº‹å‹™å±€ã«ç¢ºèªã—ã¦ãã ã•ã„ã€‚')" class="btn-choice w-full p-5 rounded-2xl text-left">
                                <span class="font-bold text-lg block">ã‚ã‹ã‚‰ãªã„ / ã„ã„ãˆ</span>
                                <span class="text-sm text-slate-400">ä¸æ˜ãªå ´åˆã¯ç´™é…å¸ƒã«ç•™ã‚ã‚‹ã®ãŒå®‰å…¨ã§ã™</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Result -->
                <div id="result-container" class="hidden">
                    <div id="result-alert" class="p-6 rounded-2xl mb-6 text-center">
                        <h3 class="font-bold text-xl mb-2" id="result-title">åˆ¤å®š</h3>
                        <p id="result-text" class="text-sm leading-relaxed"></p>
                    </div>
                    <div class="bg-blue-50 p-6 rounded-2xl mb-8">
                        <h4 class="font-bold text-blue-800 mb-2">ğŸ’¡ ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h4>
                        <p id="suggestion-text" class="text-blue-700 text-sm leading-relaxed"></p>
                    </div>
                    <div class="space-y-3">
                        <button onclick="resetChecker()" class="w-full py-4 bg-slate-800 text-white font-bold rounded-2xl hover:bg-slate-700 transition">
                            ã‚‚ã†ä¸€åº¦ãƒã‚§ãƒƒã‚¯ã™ã‚‹
                        </button>
                        <button onclick="switchTab('generator')" class="w-full py-4 bg-blue-100 text-blue-700 font-bold rounded-2xl hover:bg-blue-200 transition">
                            ã©ã“ã‹ã‚‰å–ã£ãŸã‹ï¼ˆå‡ºå…¸ï¼‰ã‚’æ›¸ã
                        </button>
                    </div>
                </div>

            </div>

            <!-- TAB 2: Generator -->
            <div id="content-generator" class="hidden p-6 md:p-10">
                <h2 class="text-xl font-bold mb-6 text-slate-800">å‡ºå…¸ï¼ˆå‚è€ƒæ–‡çŒ®ï¼‰ä½œæˆãƒ„ãƒ¼ãƒ«</h2>
                
                <div class="space-y-5">
                    <div>
                        <label class="block text-xs font-bold text-slate-400 mb-2 uppercase">ç¨®é¡</label>
                        <div class="flex bg-slate-100 p-1 rounded-xl">
                            <button onclick="setRefType('book')" id="btn-ref-book" class="flex-1 py-2 rounded-lg font-bold text-sm bg-white shadow-sm text-blue-600">æœ¬ãƒ»é›‘èªŒ</button>
                            <button onclick="setRefType('web')" id="btn-ref-web" class="flex-1 py-2 rounded-lg font-bold text-sm text-slate-500">ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ</button>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <input type="text" id="ref-title" placeholder="ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆå¿…é ˆï¼‰" class="w-full p-4 rounded-xl bg-slate-50 border-none focus:ring-2 focus:ring-blue-100 outline-none">
                        <input type="text" id="ref-author" placeholder="æ›¸ã„ãŸäººã®åå‰" class="w-full p-4 rounded-xl bg-slate-50 border-none focus:ring-2 focus:ring-blue-100 outline-none">
                        
                        <div id="fields-book" class="grid grid-cols-2 gap-4">
                            <input type="text" id="ref-publisher" placeholder="å‡ºç‰ˆç¤¾" class="col-span-2 w-full p-4 rounded-xl bg-slate-50 border-none outline-none">
                            <input type="text" id="ref-year" placeholder="å‡ºã—ãŸå¹´" class="w-full p-4 rounded-xl bg-slate-50 border-none outline-none">
                            <input type="text" id="ref-page" placeholder="ãƒšãƒ¼ã‚¸" class="w-full p-4 rounded-xl bg-slate-50 border-none outline-none">
                        </div>

                        <div id="fields-web" class="hidden space-y-4">
                            <input type="text" id="ref-url" placeholder="URL" class="w-full p-4 rounded-xl bg-slate-50 border-none outline-none">
                            <input type="date" id="ref-access-date" class="w-full p-4 rounded-xl bg-slate-50 border-none outline-none">
                        </div>
                    </div>

                    <button onclick="generateReference()" class="w-full py-4 bg-blue-600 text-white font-bold rounded-2xl hover:bg-blue-700 transition shadow-lg shadow-blue-100">
                        æ–‡ç« ã‚’ä½œã‚‹
                    </button>
                </div>

                <div id="ref-output" class="mt-8 hidden">
                    <div class="relative">
                        <textarea id="ref-result" readonly class="w-full p-5 bg-slate-800 text-white font-mono text-sm rounded-2xl min-h-[100px] border-none outline-none"></textarea>
                        <button onclick="copyToClipboard()" class="absolute top-3 right-3 bg-white/10 hover:bg-white/20 text-white px-3 py-1 rounded-lg text-[10px] font-bold">
                            ã‚³ãƒ”ãƒ¼
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <footer class="mt-8 text-center text-slate-400 text-[10px] space-y-1">
            <p>&copy; 2026 Educational Copyright Project</p>
            <p>ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€Œæˆæ¥­ç›®çš„ã€ä»¥å¤–ã®åˆ©ç”¨ã«ã¯å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚</p>
        </footer>
    </div>

    <script>
        let currentRefType = 'book';

        function switchTab(tab) {
            const isChecker = tab === 'checker';
            const cb = document.getElementById('tab-checker');
            const gb = document.getElementById('tab-generator');
            const cc = document.getElementById('content-checker');
            const gc = document.getElementById('content-generator');

            cb.className = isChecker ? "flex-1 py-3 text-sm font-bold rounded-xl transition bg-white text-blue-600 shadow-sm" : "flex-1 py-3 text-sm font-bold rounded-xl transition text-slate-500 hover:bg-white/50";
            gb.className = !isChecker ? "flex-1 py-3 text-sm font-bold rounded-xl transition bg-white text-blue-600 shadow-sm" : "flex-1 py-3 text-sm font-bold rounded-xl transition text-slate-500 hover:bg-white/50";
            
            cc.classList.toggle('hidden', !isChecker);
            gc.classList.toggle('hidden', isChecker);
        }

        function startDiagnostic() {
            document.getElementById('step0').classList.remove('active');
            document.getElementById('step1').classList.add('active');
            document.getElementById('progress-area').classList.remove('hidden');
            updateProgress(1, 7);
        }

        function updateProgress(step, total) {
            const percent = Math.round((step / total) * 100);
            document.getElementById('progress-fill').style.width = percent + '%';
            document.getElementById('progress-text').innerText = percent + '%';
        }

        function nextStep(current, choice) {
            if (current === 4 && choice === 'offline') {
                // ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ï¼ˆç´™ãƒ»æŠ•å½±ï¼‰ãªã‚‰SARTRASã®æ‰‹ç¶šãã¯ä¸è¦ãªã®ã§ã‚¸ãƒ£ãƒ³ãƒ—
                document.getElementById('step4').classList.remove('active');
                document.getElementById('step5').classList.add('active');
                updateProgress(5, 7);
                return;
            }

            const next = current + 1;
            document.getElementById(`step${current}`).classList.remove('active');
            if (document.getElementById(`step${next}`)) {
                document.getElementById(`step${next}`).classList.add('active');
                updateProgress(next, 7);
            }
        }

        function showResult(type, title, text) {
            document.getElementById('quiz-container').classList.add('hidden');
            document.getElementById('progress-area').classList.add('hidden');
            const res = document.getElementById('result-container');
            res.classList.remove('hidden');

            const alert = document.getElementById('result-alert');
            if (type === 'success') {
                alert.className = 'p-6 rounded-2xl mb-6 text-center bg-green-50 text-green-800';
            } else if (type === 'warning') {
                alert.className = 'p-6 rounded-2xl mb-6 text-center bg-orange-50 text-orange-800';
            } else {
                alert.className = 'p-6 rounded-2xl mb-6 text-center bg-red-50 text-red-800';
            }

            document.getElementById('result-title').innerText = title;
            document.getElementById('result-text').innerText = text;
            document.getElementById('suggestion-text').innerText = "å¿…ãšå‡ºå…¸ã‚’æ˜è¨˜ã—ã€ä½¿ã„çµ‚ã‚ã£ãŸè³‡æ–™ã¯é©åˆ‡ã«å‡¦åˆ†ï¼ˆå›åã¾ãŸã¯ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ï¼‰ã—ã¦ãã ã•ã„ã€‚";
        }

        function resetChecker() {
            document.getElementById('quiz-container').classList.remove('hidden');
            document.getElementById('result-container').classList.add('hidden');
            document.querySelectorAll('.step-card').forEach(s => s.classList.remove('active'));
            document.getElementById('step0').classList.add('active');
            updateProgress(0, 7);
        }

        // Generator Logic
        function setRefType(type) {
            currentRefType = type;
            const isBook = type === 'book';
            document.getElementById('btn-ref-book').className = isBook ? "flex-1 py-2 rounded-lg font-bold text-sm bg-white shadow-sm text-blue-600" : "flex-1 py-2 rounded-lg font-bold text-sm text-slate-500";
            document.getElementById('btn-ref-web').className = !isBook ? "flex-1 py-2 rounded-lg font-bold text-sm bg-white shadow-sm text-blue-600" : "flex-1 py-2 rounded-lg font-bold text-sm text-slate-500";
            document.getElementById('fields-book').classList.toggle('hidden', !isBook);
            document.getElementById('fields-web').classList.toggle('hidden', isBook);
        }

        function generateReference() {
            const title = document.getElementById('ref-title').value;
            const author = document.getElementById('ref-author').value;
            if (!title) { alert('ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }

            let res = "å‡ºå…¸ï¼š";
            if (currentRefType === 'book') {
                const pub = document.getElementById('ref-publisher').value;
                const year = document.getElementById('ref-year').value;
                const page = document.getElementById('ref-page').value;
                if (author) res += author + " ";
                res += "ã€" + title + "ã€";
                if (pub) res += " " + pub;
                if (year) res += " (" + year + ")";
                if (page) res += " " + page;
            } else {
                const url = document.getElementById('ref-url').value;
                const date = document.getElementById('ref-access-date').value;
                if (author) res += author + ", ";
                res += '"' + title + '"';
                if (url) res += " <" + url + ">";
                if (date) res += " (" + date + " é–²è¦§)";
            }

            document.getElementById('ref-result').value = res;
            document.getElementById('ref-output').classList.remove('hidden');
        }

        function copyToClipboard() {
            const el = document.getElementById('ref-result');
            el.select();
            document.execCommand('copy');
        }

        window.onload = () => {
            document.getElementById('ref-access-date').value = new Date().toISOString().split('T')[0];
        };
    </script>
</body>
</html>
